function net = create_neural_network(x,y,hidden_network,training_func,param1,param2,param3)

if nargin < 6
    param2 = 0;
    param3 = 0;
end


layers = size(hidden_network,2);
net = feedforwardnet(hidden_network, training_func);
net = configure(net, x, y);

for i = 1:layers
    net.layers{i}.transferFcn = 'tansig';
end

net.trainParam.lr = param1;
% net.trainParam.lr_inc = 1.5;
% net.trainParam.lr_dec = 0.5;
% net.trainParam.goal = 0.002;
% net.trainParam.min_grad = 3e-06;

% net.trainParam.goal = goal;
% net.trainParam.min_grad = grad;

% dividerand?
net.divideFcn = 'divide';
% just train and val?
net.divideParam.trainInd = 1:800;
net.divideParam.valInd = 801:size(x,2);
net.divideParam.testInd = [];


net.trainParam.epochs = 10000;

% net.trainParam.delt_inc = 1.2;

% net.trainParam.delt_dec = 0.9;
net = train(net,x,y);

end
